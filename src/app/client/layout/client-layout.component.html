<div class="client-app" [class.is-dark]="isDark" [ngStyle]="themeTokens">
  <div
    class="client-loading"
    *ngIf="isThemeLoading"
    role="status"
    aria-live="polite"
    [attr.aria-busy]="isThemeLoading">
    <mat-spinner diameter="36"></mat-spinner>
    <p>Cargando tu experiencia...</p>
  </div>

  <ng-container *ngIf="!isThemeLoading">
    <header class="client-header" role="banner">
      <button
        mat-icon-button
        type="button"
        class="menu-button"
        (click)="toggleDrawer()"
        [attr.aria-expanded]="drawerOpen"
        aria-label="Abrir menu">
        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 20 20">
          <path fill="#ffffff" d="M19.3 16.608c.386 0 .699.312.699.696a.7.7 0 0 1-.7.696H.703a.7.7 0 0 1-.7-.696c0-.384.314-.696.7-.696zM15.98 6.492a.7.7 0 0 1 .988.003l2.827 2.827a.7.7 0 0 1 .003.987l-2.812 2.812a.7.7 0 0 1-.987-.003a.7.7 0 0 1-.003-.987l2.32-2.32l-2.332-2.332a.7.7 0 0 1-.003-.987m-1.163 2.639c.387 0 .7.312.7.696a.7.7 0 0 1-.7.696H.7a.7.7 0 0 1-.7-.696c0-.384.313-.696.7-.696zM19.3 2c.387 0 .7.312.7.696a.7.7 0 0 1-.7.696H.703a.7.7 0 0 1-.7-.696c0-.384.314-.696.7-.696z"/>
        </svg>
      </button>
      
      <div class="header-brand" *ngIf="currentTheme as theme">
        <div class="brand-logo" *ngIf="theme.logoUrl">
          <img [src]="theme.logoUrl" [alt]="theme.appName || 'App logo'" />
        </div>
        <div class="brand-text">
          <div class="brand-name">{{ theme.appName }}</div>
          <div class="brand-tagline">{{ theme.tagline }}</div>
        </div>
      </div>
    </header>

    <div
      class="drawer-backdrop"
      [class.open]="drawerOpen"
      (click)="closeDrawer()"
      aria-hidden="true"></div>

    <aside class="client-drawer" [class.open]="drawerOpen" aria-label="Navegacion principal">
      <div class="drawer-brand" *ngIf="currentTheme as theme">
        <div class="brand-logo" *ngIf="theme.logoUrl">
          <img [src]="theme.logoUrl" [alt]="theme.appName || 'App logo'" />
        </div>
        <div class="brand-text">
          <div class="brand-name">{{ theme.appName }}</div>
          <div class="brand-tagline">{{ theme.tagline }}</div>
        </div>
      </div>

      <nav class="drawer-nav">
        <a
          class="drawer-link"
          routerLink="/client/plans"
          routerLinkActive="active"
          (click)="closeDrawer()">
          <mat-icon aria-hidden="true">fitness_center</mat-icon>
          <span>Mis planes</span>
        </a>
        <a
          class="drawer-link"
          routerLink="/client/profile"
          routerLinkActive="active"
          (click)="closeDrawer()">
          <mat-icon aria-hidden="true">person</mat-icon>
          <span>Informacion personal</span>
        </a>
        <button
          class="drawer-link logout-link"
          type="button"
          (click)="signOut(); closeDrawer()"
          [disabled]="isSigningOut">
          <mat-icon aria-hidden="true">logout</mat-icon>
          <span>Cerrar sesion</span>
        </button>
      </nav>

      <div class="debug-toggle" *ngIf="debugThemeEnabled">
        <mat-slide-toggle [checked]="debugDarkMode" (change)="onDebugThemeToggle($event.checked)">
          Debug: Dark mode
        </mat-slide-toggle>
      </div>
    </aside>

    <main class="client-content">
      <router-outlet></router-outlet>
    </main>
  </ng-container>
</div>
